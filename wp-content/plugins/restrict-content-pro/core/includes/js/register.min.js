"function"!=typeof Object.assign&&(Object.assign=function(e){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");e=Object(e);for(var r=1;r<arguments.length;r++){var t=arguments[r];if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e});var rcp_processing=!1;function rcp_get_recaptchav3_token(e){return new Promise((function(r,t){"1"===rcp_script_options.recaptcha_enabled&&"3"===rcp_script_options.recaptcha_version?grecaptcha.ready((function(){grecaptcha.execute(jQuery("#rcp_recaptcha").data("sitekey"),{action:"register"}).then((function(t){jQuery(e).find('input[name="g-recaptcha-response"]').val(t),r()}))})):r()}))}function rcp_validate_registration_form(e){let r=jQuery;return new Promise((function(t,a){r.post(rcp_script_options.ajaxurl,e.serialize()+"&action=rcp_process_register_form&rcp_ajax=true&validate_only=true",(function(i){r(".rcp-submit-ajax",e).remove(),r(".rcp_message.error",e).remove(),i.success?(r("body").trigger("rcp_registration_form_validated",[e,i.data]),t(i.data)):a(i.data)})).done((function(e){})).fail((function(e){console.log(e),a(Error(e))})).always((function(e){}))}))}function rcp_process_registration_form(e){let r=jQuery;return rcp_processing=!0,new Promise((function(t,a){r.post(rcp_script_options.ajaxurl,e.serialize()+"&action=rcp_process_register_form&rcp_ajax=true",(function(e){e.success?t(e.data):a(e.data)})).done((function(e){})).fail((function(e){console.log(e)})).always((function(e){}))}))}function rcp_regenerate_registration_nonce(e,r){let t=jQuery;return rcp_processing=!0,new Promise((function(a,i){t.ajax({type:"post",dataType:"json",url:rcp_script_options.ajaxurl,data:{action:"rcp_generate_registration_nonce"},success:function(t){t.success?(r.nonce=t.data,e.find('input[name="rcp_register_nonce"]').val(r.nonce),a(r)):i(r)}})}))}function rcp_submit_registration_form(e,r){rcp_processing=!0,e.submit()}function rcp_handle_registration_errors(e,r){let t=jQuery;void 0===r&&(r=t("#rcp_registration_form")),void 0===e.errors&&(e.errors='<div class="rcp_message error" role="list"><p class="rcp_error" role="listitem">'+rcp_script_options.error_occurred+"</p></div>"),r.find("#rcp_submit").val(rcp_script_options.register).before(e.errors),r.find('input[name="rcp_register_nonce"]').val(e.nonce),r.unblock(),rcp_processing=!1}function rcp_get_gateway(){let e,r=jQuery;return r("#rcp_payment_gateways").length>0?(e=r("#rcp_payment_gateways select option:selected"),e.length<1&&(e=r('input[name="rcp_gateway"]:checked'))):e=r('input[name="rcp_gateway"]'),e}function rcp_get_registration_form_state(){let e=jQuery,r=e("#rcp_subscription_levels .rcp_level:checked");return r.length||(r=e("#rcp_registration_form").find("input[name=rcp_level]")),{membership_level:r.val(),is_free:0==r.attr("rel"),lifetime:"forever"===r.data("duration"),level_has_trial:-1!==rcp_script_options.trial_levels.indexOf(r.val()),discount_code:e("#rcp_discount_code").val(),gateway:rcp_get_gateway().val(),gateway_data:rcp_get_gateway(),auto_renew:e("#rcp_auto_renew").prop("checked")}}function rcp_validate_registration_state(e,r){e||(e=rcp_get_registration_form_state());let t=jQuery,a=t("#rcp_registration_form");a.block({message:rcp_script_options.pleasewait,css:{border:"none",padding:"15px",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px",opacity:.5,color:"#fff"}});let i=a.serialize()+"&action=rcp_validate_registration_state&rcp_ajax=true&rcp_level="+e.membership_level+"&lifetime="+e.lifetime+"&level_has_trial="+e.level_has_trial+"&is_free="+e.is_free+"&discount_code="+e.discount_code+"&rcp_gateway="+e.gateway+"&rcp_auto_renew="+(!0===e.auto_renew||"")+"&event_type="+r+"&registration_type="+t("#rcp-registration-type").val()+"&membership_id="+t("#rcp-membership-id").val()+"&rcp_registration_payment_id="+t("#rcp-payment-id").val();t.ajax({type:"post",dataType:"json",url:rcp_script_options.ajaxurl,data:i,success:function(e){e.success?(t(".rcp_gateway_"+e.data.gateway+"_fields").length&&e.data.show_gateway_fields||(t("#rcp_gateway_extra_fields").remove(),1==e.data.show_gateway_fields&&e.data.gateway_fields&&(t(".rcp_gateway_fields").length?t('<div class="rcp_gateway_'+e.data.gateway+'_fields" id="rcp_gateway_extra_fields">'+e.data.gateway_fields+"</div>").insertAfter(".rcp_gateway_fields"):t('<div class="rcp_gateway_'+e.data.gateway+'_fields" id="rcp_gateway_extra_fields">'+e.data.gateway_fields+"</div>").insertAfter(".rcp_gateways_fieldset"),t("body").trigger("rcp_gateway_loaded",e.data.gateway))),rcp_prepare_registration_fields(e.data)):console.log(e),t("#rcp_registration_form").unblock()}})}function rcp_prepare_registration_fields(e){let r=jQuery;if(e.recurring_available?r("#rcp_auto_renew_wrap").show():(r("#rcp_auto_renew_wrap").hide(),r("#rcp_auto_renew_wrap input").prop("checked",!1)),e.level_has_trial&&e.trial_eligible&&(r("#rcp_auto_renew_wrap").hide(),r("#rcp_auto_renew_wrap input").prop("checked",!0)),e.initial_total>0||e.recurring_total>0?r(".rcp_gateway_fields").show():r(".rcp_gateway_fields").hide(),e.show_gateway_fields?r("#rcp_gateway_extra_fields").show():r("#rcp_gateway_extra_fields").remove(),r(".rcp_discount_amount").remove(),r(".rcp_discount_valid, .rcp_discount_invalid").hide(),e.discount_code){e.discount_valid?(r(".rcp_discount_valid").show(),r("#rcp_discount_code_wrap label").append('<span class="rcp_discount_amount"> - '+e.discount_amount+"</span>"),e.full_discount?r(".rcp_gateway_fields").addClass("rcp_discounted_100"):r(".rcp_gateway_fields").removeClass("rcp_discounted_100")):(r(".rcp_discount_invalid").show(),r(".rcp_gateway_fields").removeClass("rcp_discounted_100"));let t={valid:e.discount_valid,full:e.full_discount,amount:e.discount_amount};r("body").trigger("rcp_discount_applied",[t])}r(".rcp_registration_total").html(e.total_details_html)}function rcp_validate_recaptcha(e){jQuery("#rcp_registration_form #rcp_submit").prop("disabled",!1)}jQuery(document).ready((function(e){rcp_validate_registration_state(),e("#rcp-membership-renew-upgrade-toggle").on("click",(function(r){r.preventDefault(),e("#rcp-membership-renew-upgrade-choice").toggle()})),e("#rcp_payment_gateways select, #rcp_payment_gateways input").on("change",(function(){e("body").trigger("rcp_gateway_change",{gateway:rcp_get_gateway().val()})})),e(".rcp_level").on("change",(function(){e("body").trigger("rcp_level_change",{subscription_level:e("#rcp_subscription_levels .rcp_level:checked").val()})})),e("#rcp_apply_discount").on("click",(function(r){r.preventDefault(),e("body").trigger("rcp_discount_change",{discount_code:e("#rcp_discount_code").val()})})),e("#rcp_auto_renew").on("change",(function(){e("body").trigger("rcp_auto_renew_change",{auto_renew:e(this).prop("checked")})})),e("body").on("rcp_discount_change rcp_level_change rcp_gateway_change rcp_auto_renew_change",(function(e,r){rcp_validate_registration_state(Object.assign({},rcp_get_registration_form_state(),r),e.type)})),"1"===rcp_script_options.recaptcha_enabled&&"3"!==rcp_script_options.recaptcha_version&&jQuery("#rcp_registration_form #rcp_submit").prop("disabled",!0),e(document).on("click","#rcp_registration_form #rcp_submit",(function(r){r.preventDefault();var t=document.getElementById("rcp_registration_form"),a=e("#rcp_registration_form");if(("function"!=typeof t.checkValidity||!1!==t.checkValidity())&&(a.block({message:rcp_script_options.pleasewait,css:{border:"none",padding:"15px",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px",opacity:.5,color:"#fff"}}),e("#rcp_submit",a).val(rcp_script_options.pleasewait),!rcp_processing)){rcp_processing=!0;var i=(window.rcpRegistrationChecks||[]).map((function(e){return e(a)}));Promise.all(i).then((function(){return rcp_get_recaptchav3_token(a)})).then((function(){return rcp_validate_registration_form(a)})).then((function(e){return rcp_process_registration_form(a)})).then((function(e){return rcp_regenerate_registration_nonce(a,e)})).then((function(r){let t=a.find('input[name="rcp_registration_payment_id"]');t.length?t.val(r.payment_id):a.append('<input type="hidden" name="rcp_registration_payment_id" value="'+r.payment_id+'"/>'),e("body").trigger("rcp_register_form_submission",[r,a.attr("id")]);let i=!1;r.gateway.supports&&-1!==r.gateway.supports.indexOf("gateway-submits-form")&&(i=!0),0===r.total&&0===r.recurring_total||!i?rcp_submit_registration_form(a,r):e("body").trigger("rcp_registration_form_processed",[a,r])})).catch((function(e){console.trace("Registration Error",e),rcp_regenerate_registration_nonce(a,e).then((function(e){rcp_handle_registration_errors(e,a)})).catch((function(r){rcp_handle_registration_errors(e,a)}))}))}}))}));var rcp_validating_discount=!1,rcp_validating_gateway=!1,rcp_validating_level=!1,rcp_calculating_total=!1;function rcp_validate_form(e){rcp_validate_registration_state()}function rcp_validate_subscription_level(){rcp_validating_level||(rcp_validating_level=!0,rcp_validate_registration_state(),rcp_validating_level=!1)}function rcp_validate_gateways(){rcp_validating_gateway||(rcp_validating_gateway=!0,rcp_validate_registration_state(),rcp_validating_gateway=!1)}function rcp_validate_discount(){rcp_validating_discount||(rcp_validating_discount=!0,rcp_validate_registration_state(),rcp_validating_discount=!1)}function rcp_calc_total(){rcp_calculating_total||(rcp_calculating_total=!0,rcp_validate_registration_state(),rcp_calculating_total=!1)}