"use strict";var RCP_Import={listen:function(){var e=this;jQuery(".rcp-import-form").ajaxForm({beforeSubmit:e.before_submit,success:e.success,complete:e.complete,dataType:"json",error:e.error})},before_submit:function(e,r,t){let o=r.find("#rcp-import-csv-errors"),s=r.find(".spinner");if(o.empty().hide(),s.addClass("is-active").show(),!(window.File&&window.FileReader&&window.FileList&&window.Blob))return o.append(rcp_csv_import_vars.unsupported_browser).show(),s.removeClass("is-active").hide(),!1},success:function(e,r,t,o){},complete:function(e){const r=jQuery.parseJSON(e.responseText),t=jQuery(".rcp-import-form");if(t.find(".spinner").removeClass("is-active").hide(),r.success){t.find(".rcp-import-file-wrap").remove(),t.find(".rcp-import-options").slideDown();let e=t.find("select.rcp-import-csv-column"),o="",s=r.data.columns.sort((function(e,r){return e<r?-1:e>r?1:0}));jQuery.each(s,(function(e,r){o+='<option value="'+r+'">'+r+"</option>"})),e.append(o),e.on("change",(function(){const e=jQuery(this).val();e&&!1!==r.data.first_row[e]?jQuery(this).parent().next().html(r.data.first_row[e]):jQuery(this).parent().next().html("")})),jQuery.each(e,(function(){jQuery(this).val(jQuery(this).attr("data-field")).change()})),jQuery(document.body).on("click",".rcp-import-proceed",(function(e){e.preventDefault(),jQuery(this).parents(".submit").find(".spinner").addClass("is-active").show(),r.data.mapping=t.serialize(),RCP_Import.begin_import(r.data)}))}else RCP_Import.error(e)},error:function(e){let r=jQuery("#rcp-import-csv-errors");r.empty();const t=jQuery.parseJSON(e.responseText);t.success?r.hide():r.append(t.data.message).show()},begin_import:function(e){e.action="rcp_process_csv_import",jQuery.ajax({dataType:"json",data:e,type:"POST",url:ajaxurl,success:function(e){e.success&&(window.location=e.data)},error:function(e){console.log(new Date+" error"),console.log(e)}})}};jQuery(document).ready((function(){RCP_Import.listen()}));