function validatePositiveNumber(e){e.value<0&&(e.value=0)}jQuery(document).ready((function(e){e(".rcp-help-tip").tooltip({content:function(){return e(this).prop("title")},position:{my:"center top",at:"center bottom+10",collision:"flipfit"},hide:{duration:500},show:{duration:500}});var t,i=e("#rcp-restrict-by"),r=e("#rcp-metabox-field-role"),n=e("#rcp-metabox-field-levels"),c=e(".rcp-subscription-levels"),s=e("input[name=rcp_subscription_level_any_set]"),a=e("#rcp-metabox-field-access-levels"),o=e("#rcp-metabox-field-options"),p=function(e){"unrestricted"===e&&(r.hide(),n.hide(),a.hide(),o.hide()),"registered-users"===e&&(r.show(),n.hide(),a.hide(),o.show()),"subscription-level"===e&&(r.show(),n.show(),a.hide(),o.show()),"access-level"===e&&(r.show(),n.hide(),a.show(),o.show())},l=function(e){"any"===e&&c.hide(),"any-paid"===e&&c.hide(),"specific"===e&&(s.show(),c.show(),a.hide(),o.show())},d=i.val();if(p(d),i.on("change",(function(){var t=e(this).val();p(t)})),s.on("change",(function(){var t=e(this).val();l(t)})),e(".rcp-user-role").on("change",(function(t){var i=e(this).val();"all"===i&&this.checked?e(this).parents("p").find("input:checkbox").each((function(){"all"!==e(this).val()&&e(this).removeAttr("checked")})):"all"!==i&&this.checked&&e("#rcp_user_level_all").removeAttr("checked")})),e(window).on("hashchange",(function(t){if(0==e("#rcp-settings-wrap").length)return;let i=window.location.hash;i&&(i=i.replace(/[^a-zA-Z0-9]/g,"")),jQuery("#rcp-settings-wrap #tab_container .tab_content").hide(),jQuery("#rcp-settings-wrap #tab_container").children(".tab_content").hide(),jQuery("#rcp-settings-wrap .nav-tab-wrapper a").removeClass("nav-tab-active"),i&&jQuery.inArray(i,["general","payments","emails","invoices","misc"])?(jQuery('#rcp-settings-wrap .nav-tab-wrapper a[href="#'+i+'"]').addClass("nav-tab-active"),jQuery("#rcp-settings-wrap #tab_container #"+i).addClass("selected").fadeIn()):(jQuery('#rcp-settings-wrap  h2.nav-tab-wrapper a[href="#general"]').addClass("nav-tab-active"),jQuery("#rcp-settings-wrap  #tab_container #general").addClass("selected nav-tab-active").fadeIn())})),e(window).trigger("hashchange"),e(".rcp-datepicker").length>0){e(".rcp-datepicker").datepicker({dateFormat:"yy-mm-dd",beforeShow:function(){e(this).datepicker("widget").addClass("rcp-datepicker-wrap")},onClose:function(){e(this).datepicker("widget").removeClass("rcp-datepicker-wrap")}})}e(".rcp-datetimepicker").length>0&&e(".rcp-datetimepicker").datetimepicker({dateFormat:"yy-mm-dd",timeFormat:"HH:mm:ss",beforeShow:function(t,i,r){e("#ui-datepicker-div").addClass("rcp-datepicker-wrap")},onClose:function(t,i){e("#ui-datepicker-div").removeClass("rcp-datepicker-wrap")}}),e(".rcp_cancel").on("click",(function(){return!e(this).is("[disabled=disabled]")&&!!confirm(rcp_vars.cancel_user)})),e("#rcp-expire-membership-button").on("click",(function(){return!!confirm(rcp_vars.expire_membership)})),e(".rcp_delete_subscription").on("click",(function(){return!!confirm(rcp_vars.delete_subscription)})),e(".rcp-delete-payment").on("click",(function(){return!!confirm(rcp_vars.delete_payment)})),e(".rcp_delete_discount").on("click",(function(){return!!confirm(rcp_vars.delete_discount)})),e(".rcp-delete-reminder").on("click",(function(){return!!confirm(rcp_vars.delete_reminder)})),e(".rcp-delete-membership").on("click",(function(){return!!confirm(rcp_vars.delete_membership)})),e(".rcp-delete-customer").on("click",(function(){return!!confirm(rcp_vars.delete_customer)})),e("#rcp-add-new-member").on("submit",(function(){return""!=e("#rcp-user").val()||(alert(rcp_vars.missing_username),!1)})),e(".rcp-subscriptions tbody").length&&(e(".rcp-subscriptions tbody tr").each((function(){let t=e(this).find(".check-column input").val();e(this).attr("id","recordsArray_"+t),e(this).addClass("rcp-subscription rcp_row")})),e(".rcp-subscriptions tbody").sortable({handle:".rcp-drag-handle",items:"tr",opacity:.6,cursor:"move",axis:"y",update:function(){var t=e(this).sortable("serialize")+"&action=update-subscription-order";e.post(ajaxurl,t,(function(e){}))}})),e("#rcp-membership-level").on("change",(function(){var t=e("option:selected",this).val();data={action:"rcp_get_subscription_expiration",subscription_level:t},e.post(ajaxurl,data,(function(t){let i=e("#rcp-membership-expiration"),r=e("#rcp-membership-expiration-none");"none"===t?(i.val(""),r.prop("checked",!0)):(i.val(t),r.prop("checked",!1))}))})),e(".rcp-user-search").on("keyup",(function(){var t=e(this).val();e(".rcp-ajax").show(),data={action:"rcp_search_users",user_name:t,return_field:e(this).data("return-field"),rcp_nonce:rcp_vars.rcp_member_nonce},e.ajax({type:"POST",data:data,dataType:"json",url:ajaxurl,success:function(t){e(".rcp-ajax").hide();let i=e("#rcp_user_search_results");i.html(""),"found"==t.id?e(t.results).appendTo("#rcp_user_search_results"):"fail"==t.id&&i.html(t.msg),e(document).on("click",(function(t){let r=e(t.target);r.closest(".rcp-user-search").length||r.closest("#rcp_user_search_results").length||i.html("")}))}})})),e("body").on("click.rcpSelectUser","#rcp_user_search_results a",(function(t){t.preventDefault();var i=e(this).data("login");e(".rcp-user-search").val(i),e("#rcp_user_search_results").html("")})),e("#rcp-graphs-date-options").on("change",(function(){"other"==e(this).val()?e("#rcp-date-range-options").show():e("#rcp-date-range-options").hide()})),e("#rcp-unlimited").on("change",(function(){e(this).attr("checked")?e("#rcp-expiration").val("none"):"none"==e("#rcp-expiration").val()&&e("#rcp-expiration").val("").trigger("focus")})),e("body").on("click",".rcp-upload",(function(i){i.preventDefault();var r=e(this).prev();t||((t=wp.media.frames.file_frame=wp.media({frame:"select",title:rcp_vars.choose_logo,multiple:!1,library:{type:"image"},button:{text:rcp_vars.use_as_logo}})).on("menu:render:default",(function(e){e.unset("library-separator"),e.unset("gallery"),e.unset("featured-image"),e.unset("embed"),e.set({})})),t.on("select",(function(){var e=t.state().get("selection").first().toJSON();r.val(e.url)}))),t.open()})),e("#rcp-bulk-select-all").on("change",(function(){e(this).prop("checked")?e("#rcp-members-form .rcp-member-cb").prop("checked",!0):e("#rcp-members-form .rcp-member-cb").prop("checked",!1)})),e("#rcp-status").on("change",(function(){"cancelled"==e(this).val()?(rcp_vars.can_cancel_member&&e(this).parent().append('<p id="rcp-cancel-subscription-wrap"><input type="checkbox" id="rcp-cancel-subscription" name="cancel_subscription" value="1"><label for="rcp-cancel-subscription">'+rcp_vars.cancel_subscription+"</label></p>"),e("#rcp-revoke-access-wrap").show()):(e("#rcp-cancel-subscription-wrap").remove(),e("#rcp-revoke-access-wrap").hide())})),e("#rcp-bulk-member-action").on("change",(function(){"mark-cancelled"==e(this).val()?e("#rcp-revoke-access-wrap").show():e("#rcp-revoke-access-wrap").hide()})),e("#rcp_settings_auto_renew").on("change",(function(){"3"==e(this).val()?e(this).parents("tr").next().css("display","table-row"):e(this).parents("tr").next().css("display","none")})),e(".rcp-disable-email").on("change",(function(){var t=e(this).parents("tr").next(),i=t.next();!0===("SELECT"==e(this).prop("tagName")&&"off"==e(this).val()||e(this).prop("checked"))?(t.css("display","none"),i.css("display","none")):(t.css("display","table-row"),i.css("display","table-row"))})),e("#rcp-maximum-renewals-setting").on("change",(function(){var t=e(this).parents("tr").next(),i="forever"!==e(this).val();e("#rcp-maximum-renewals").toggle(i),t.toggle(i)}));var u=e("#rcp_settings\\[currency\\]");if(u.length){var h=JSON.parse(rcp_vars.currencies),m=h[u.val()].match(/\(([^)]+)\)/);m=null==m?u.val():m[1];var _=e('#rcp_settings\\[currency_position\\] option[value="before"]'),b=e('#rcp_settings\\[currency_position\\] option[value="after"]');_.text((function(){return"NOK"===u.val()&&(m+=" "),e(this).text().replace("$",m)})),b.text((function(){return"NOK"===u.val()&&(m=" "+m),e(this).text().replace("$",m)})),e(u).on("change",(function(){var t=e(this).val(),i=h[e(this).val()].match(/\(([^)]+)\)/);i=null==i?t:i[1],_.text((function(){return"NOK"===t&&(i+=" "),e(this).text().replace(m,i)})),b.text((function(){return"NOK"===t&&(i=" "+i),e(this).text().replace(m,i)})),m=i}))}e('input[name="rcp_customer_user_account"]:radio').on("change",(function(){"new"===this.value?e(".rcp-customer-new-user-field").show():e(".rcp-customer-new-user-field").hide()}));var g={vars:{member_card_wrap_editable:e(".rcp-membership-card-wrapper .rcp-editable"),member_card_wrap_edit_item:e(".rcp-membership-card-wrapper .rcp-edit-item")},init:function(){this.recurring_select(),this.edit_membership_level(),this.confirm_level_change(),this.edit_recurring_price(),this.edit_created_date(),this.edit_expiration(),this.never_expires(),this.edit_gateway_customer_id(),this.edit_gateway_subscription_id(),this.set_billing_cycle(),e("#rcp-add-membership-info #rcp-membership-level").trigger("change")},edit_membership_input:function(e,t){e.text()===rcp_vars.action_edit?(e.data("current-value",t.val()),e.text(rcp_vars.action_cancel)):(t.val(e.data("current-value")),e.text(rcp_vars.action_edit))},edit_membership_level:function(){e("#rcp-edit-membership-level").on("click",(function(t){t.preventDefault();let i=e(this),r=e("#rcp-membership-level");g.edit_membership_input(i,r),e(".rcp-current-membership-level").toggle(),e("#rcp-membership-level").toggle(),e("#rcp-change-membership-level-button").toggle()}))},confirm_level_change:function(){e("#rcp-change-membership-level-button").on("click",(function(e){return!!confirm(rcp_vars.change_membership_level)}))},recurring_select:function(){e(document.body).on("change","#rcp-recurring",(function(t){e(this).prop("checked")?(e("#rcp-membership-recurring-enable-auto-renew").show(),e("#rcp-membership-recurring-disable-auto-renew").hide()):(e("#rcp-membership-recurring-enable-auto-renew").hide(),e("#rcp-membership-recurring-disable-auto-renew").show()),e("#rcp-membership-recurring-update-notice").slideToggle()}))},edit_recurring_price:function(){let t=e("#rcp-recurring-amount");t.length&&t.on("keyup",(function(t){e("#rcp-membership-recurring-price-update-notice").slideDown()}))},edit_created_date:function(){e("#rcp-edit-membership-created").on("click",(function(t){t.preventDefault();let i=e(this),r=e("#rcp-membership-created");g.edit_membership_input(i,r),e(".rcp-membership-created").toggle()}))},edit_expiration:function(){e("#rcp-edit-membership-expiration").on("click",(function(t){t.preventDefault();let i=e(this),r=e("#rcp-membership-expiration");g.edit_membership_input(i,r),e(".rcp-membership-expiration").toggle(),e("#rcp-membership-expiration-update-notice").slideToggle(),e(".rcp-membership-expiration-none-wrap").toggle()}))},never_expires:function(){e("#rcp-membership-expiration-none").on("change",(function(){e(this).is(":checked")&&e("#rcp-membership-expiration").val("")}))},edit_gateway_customer_id:function(){e("#rcp-edit-membership-gateway-customer-id").on("click",(function(t){t.preventDefault();let i=e(this),r=e("#rcp-membership-gateway-customer-id");g.edit_membership_input(i,r),e("#rcp-membership-gateway-customer-id").toggle()}))},edit_gateway_subscription_id:function(){e("#rcp-edit-membership-gateway-subscription-id").on("click",(function(t){t.preventDefault();let i=e(this),r=e("#rcp-membership-gateway-subscription-id");g.edit_membership_input(i,r),e("#rcp-membership-gateway-subscription-id").toggle(),e("#rcp-membership-gateway-subscription-id-update-notice").slideToggle()}))},set_billing_cycle:function(){e("#rcp-add-membership-info").on("change","#rcp-membership-level",(function(){let t=e(this).val(),i=e("#rcp-initial-amount"),r=e("#rcp-recurring-amount"),n=e("#rcp-billing-cycle-recurring"),c={action:"rcp_get_membership_billing_cycle",object_id:t,rcp_nonce:rcp_vars.rcp_member_nonce};e.post(ajaxurl,c,(function(e){"free"===e.data?(i.val("0.00"),r.val("0.00")):(i.val(e.data.initial_amount),r.val(e.data.recurring_amount)),"free"===e.data||0==e.data.recurring_amount?n.hide():n.show()}))}))}};g.init();let v={init:function(){this.listeners()},listeners:function(){let e=document.getElementById("rcp_settings[sandbox]");e&&e.addEventListener("change",(function(){let e=document.getElementById("rcp_settings[stripe_test_publishable]"),t=document.getElementById("rcp_settings[stripe_live_publishable]"),i=document.getElementById("rcp-sandbox-toggle-notice");this.checked&&""===e.value&&v.showErrorNotice(i),this.checked||""!==t.value||v.showErrorNotice(i)}))},showErrorNotice:function(e=!1){e&&(e.className="notice error",e.style.visibility="visible")}};"restrict_page_rcp-settings"===window.adminpage&&v.init(),e("#general-tab").on("click",(function(){e(".rcp_options_form").attr("action","options.php#general")})),e("#general-tab").hasClass("nav-tab-active")&&e(".rcp_options_form").attr("action","options.php#general"),e("#payments-tab").on("click",(function(){e(".rcp_options_form").attr("action","options.php#payments")})),e("#payments-tab").hasClass("nav-tab-active")&&e(".rcp_options_form").attr("action","options.php#payments"),e("#emails-tab").on("click",(function(){e(".rcp_options_form").attr("action","options.php#emails")})),e("#emails-tab").hasClass("nav-tab-active")&&e(".rcp_options_form").attr("action","options.php#emails"),e("#invoices-tab").on("click",(function(){e(".rcp_options_form").attr("action","options.php#invoices")})),e("#invoices-tab").hasClass("nav-tab-active")&&e(".rcp_options_form").attr("action","options.php#invoices"),e("#misc-tab").on("click",(function(){e(".rcp_options_form").attr("action","options.php#misc")})),e("#misc-tab").hasClass("nav-tab-active")&&e(".rcp_options_form").attr("action","options.php#misc"),e("#rcp_settings[gateways][twocheckout]").attr("checked",!1)&&(e(".twocheckout_settings").hide(),e(".twocheckout_secret_word").hide(),e(".twocheckout_private_key").hide(),e(".twocheckout_test_publishable_key").hide(),e(".twocheckout_test_seller_id").hide(),e(".twocheckout_live_private_key").hide(),e(".twocheckout_live_publishable_key").hide(),e(".twocheckout_live_seller_id").hide()),e("#rcp-code").on("focusout",(function(){e(this).val(e(this).val().replace(/[^a-z0-9]/gi,""))})),e("#rcp_settings\\[statement_descriptor\\]").on("keypress",(function(t){let i=e(this).val(),r=t.keyCode?t.keyCode:t.which;return(r>=65&&r<=90||r>=97&&r<=122||r>=48&&r<=57)&&(i.length>22&&(i=i.substring(0,22)),e(this).val(i),!0)})),e("#restrict_content_legacy_switch").on("click",(function(){e.ajax({data:{action:"rc_process_legacy_switch",rc_process_legacy_nonce:e("#rcp_settings_nonce").val()},type:"post",url:ajaxurl,success:function(e){e.success&&window.location.assign(rcp_vars.downgrade_redirect)},error:function(e){console.error(e)}})})),e(".toggle-credentials").on("click",(function(){let t=e(this).attr("toggle").toString(),i=e(document.getElementById(t));"password"===e(i).attr("type")?(e(i).attr("type","text"),e(this).removeClass("dashicons dashicons-visibility"),e(this).addClass("dashicons dashicons-hidden")):(e(i).attr("type","password"),e(this).removeClass("dashicons dashicons-hidden"),e(this).addClass("dashicons dashicons-visibility"))})),e("#rcp_setting_braintree_toggle_live").on("click",(function(){var e=document.getElementById("rcp_setting_braintree_toggle_live"),t=document.getElementById("rcp_settings[braintree_live_encryptionKey]"),i=document.getElementById("rcp_settings[braintree_live_encryptionKey_input]");"none"===t.style.display?(i.style.display="none",t.style.display="inline-block",e.className="",e.className="dashicons dashicons-hidden"):(i.style.display="inline-block",t.style.display="none",e.className="",e.className="dashicons dashicons-visibility")})),e("#rcp_setting_braintree_toggle_sandbox").on("click",(function(){var e=document.getElementById("rcp_setting_braintree_toggle"),t=document.getElementById("rcp_settings[braintree_sandbox_encryptionKey]"),i=document.getElementById("rcp_settings[braintree_sandbox_encryptionKey_input]");"none"===t.style.display?(i.style.display="none",t.style.display="inline-block",e.className="",e.className="dashicons dashicons-hidden"):(i.style.display="inline-block",t.style.display="none",e.className="",e.className="dashicons dashicons-visibility")})),e("body").addClass("restrict-content")}));